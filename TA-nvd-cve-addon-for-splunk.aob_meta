{"basic_builder": {"appname": "TA-nvd-cve-addon-for-splunk", "friendly_name": "NVD CVE Addon For Splunk", "version": "1.0.1", "author": "FDSE", "description": "", "theme": "#65A637", "large_icon": "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", "small_icon": "iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAx1JREFUWEftmHlPKkEQxBtFxBNB8Ubw9vt/GvDCO16IggqIRvPrvN6MCAu7vvjIi/2Xujsz1VXVNRsj0mcV6TM80t+A8vn8+79gbGdnxyPmE0O/gP7I8X8zFI/Htc9IJCKvr6/SbDYD2zA0QwMDA7KxsSH1el1qtZokk0l5fHyUi4sLBbG4uCjj4+Nyd3cnAB0ZGZH9/X15f/efldCAEomEPDw89MwArAGwWq36rgkNCHYODg68jufn5wWQMMDhb29vcn19LZVKxZNxbW1N1/hVIEDINDExIel0WumnstmsPD09ye3t7ZdzALa6uqrAkJMCVLlclvv7+7byBQK0tbUlu7u7ygBM2O8ctLm5qUYuFoueh/DN4eGhjI2NqVyXl5feWt7f29v70kQgQCsrK3JycqKbIJmxNDQ0pAB5DgBqe3tbCoWCTE5OqmwAohHzUC6Xk6Ojo+8BQqqbmxvtmJF+eXnRDXsBxHvIZwymUimdwNYKxJBJZN2z2dTUlMRiMd0chszE09PTytDS0pI8Pz+rb+x9/OPu4YLqGRBZQlfkjDE1MzMjpVKpa7ZwoMlt3slkMso2ORYaEIvxwfDwsG4EO3TbSxGUNOOaGemZ0FCAmBgSmdHHM41GQ8HxdyTxK/c9dxgwusWBre9ZMkAgFV26KW2d+wFymTTvIBkx0Hrf9QyIA83UhJuNt5tFnUC5I47Jz8/PP2VYKMlYhIlJZJcVkvr4+NhXMgMNU9x/ZBaXsU1eaEDLy8tydnam663r0dFRvbfwVLvCcwAhFtwcckM2NCAmxNKZ7CGFGV38gLHpnuuDikajms68Q7obSwCEofX1dW+v0IDsE2J2dlZvbbJpbm7Okwxgp6enur8ZH2B4jjuQgiWyywK0ldVApnYXcwjXAN0CZHBwULOJyaH4KlhYWJCrqytlDmbwm10dnUwXGlA7U5rpDZD7MQa7gOzETOAcau2IAwg5coRDyCh+tjhAGrILjwEEz5n//EYyNEPtNsVTSAdYpu5HP/J9g+cbD/8qQ9/A4S39BdSNxY4MdVv4E8/7+/9DP8FAtzM+AM+QJUNo5xoEAAAAAElFTkSuQmCC", "visible": true, "tab_version": "4.1.3", "tab_build_no": "0", "build_no": 1}, "data_input_builder": {"datainputs": [{"index": "default", "sourcetype": "nvd:cve", "interval": "3600", "use_external_validation": true, "streaming_mode_xml": true, "name": "nvd_cve", "title": "NVD CVE", "description": "", "type": "customized", "parameters": [{"name": "published_start_date", "label": "Published start date", "help_string": "YYYY-MM-DD HH:mm. Start time in UTC. Should not be more than 120 days days from now. ", "required": true, "format_type": "text", "default_value": "", "placeholder": "YYYY-MM-DD HH:mm", "type": "text", "value": "2023-02-08 00:00"}, {"name": "api_key", "label": "API Key", "help_string": "Optional. Get a NIST NVD API key here (free):  https://nvd.nist.gov/developers/request-an-api-key ", "required": false, "format_type": "password", "default_value": "", "placeholder": "", "type": "password", "value": ""}], "data_inputs_options": [{"type": "customized_var", "name": "published_start_date", "title": "Published start date", "description": "YYYY-MM-DD HH:mm. Start time in UTC. Should not be more than 120 days days from now. ", "required_on_edit": false, "required_on_create": true, "format_type": "text", "default_value": "", "placeholder": "YYYY-MM-DD HH:mm"}, {"type": "customized_var", "name": "api_key", "title": "API Key", "description": "Optional. Get a NIST NVD API key here (free):  https://nvd.nist.gov/developers/request-an-api-key ", "required_on_edit": false, "required_on_create": false, "format_type": "password", "default_value": "", "placeholder": ""}], "code": "\n# encoding = utf-8\n\nimport os\nimport sys\nimport time\nfrom datetime import datetime, timedelta\nimport nvdlib\nimport json\nimport ast\n'''\n    IMPORTANT\n    Edit only the validate_input and collect_events functions.\n    Do not edit any other part in this file.\n    This file is generated only once when creating the modular input.\n'''\n'''\n# For advanced users, if you want to create single instance mod input, uncomment this method.\ndef use_single_instance_mode():\n    return True\n'''\n\ndef validate_input(helper, definition):\n    \"\"\"Implement your own validation logic to validate the input stanza configurations\"\"\"\n    # This example accesses the modular input variable\n    # api_key = definition.parameters.get('api_key', None)\n    pass\n\ndef get_start_date(helper, check_point_key):\n    \n    # Try to get a date from the check point first\n    d = helper.get_check_point(check_point_key)\n    \n    # If there was a check point date, retun it.\n    if (d not in [None,'']):\n        return d\n    else:\n        # No check point date, so look if a start date was specified as an argument\n        d = helper.get_arg(\"published_start_date\")\n        if (d not in [None,'']):\n            return d\n\ndef collect_events(helper, ew):\n\n    check_point_key = \"%s_obj_checkpoint\" % helper.get_input_stanza_names()\n    start_date = get_start_date(helper,check_point_key)\n    opt_api_key = helper.get_arg('api_key')\n    current_utc_datetime = datetime.utcnow()\n    current_utc_string = current_utc_datetime.strftime(\"%Y-%m-%d %H:%M\")\n    \n    if  opt_api_key == \"\":\n        res = nvdlib.searchCVE(pubStartDate=start_date, pubEndDate=current_utc_string)\n    else:\n        res = nvdlib.searchCVE(pubStartDate=start_date, pubEndDate=current_utc_string, key=opt_api_key)\n    \n    for r in res:\n        event = helper.new_event(source=helper.get_input_type(), index=helper.get_output_index(), sourcetype=helper.get_sourcetype(), data=json.dumps(ast.literal_eval(str(r))))\n        ew.write_event(event)\n    helper.save_check_point(check_point_key, current_utc_string)\n    \n    \n", "customized_options": [{"name": "published_start_date", "value": "2023-02-08 00:00"}], "uuid": "be06c98841e743ccbfe7c428239a4bd0", "sample_count": "2366"}]}, "field_extraction_builder": {"nvd:cve": {"data_format": "unstructured_data"}}, "global_settings_builder": {"global_settings": {"log_settings": {}}}, "sourcetype_builder": {"nvd:cve": {"metadata": {"event_count": 0, "data_input_name": "nvd_cve", "extractions_count": 0, "cims_count": 0}}}, "validation": {"validators": ["best_practice_validation"], "status": "job_finished", "validation_id": "v_1675890287_27", "progress": 1.0}}